<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第1回 N4/5 Grammar Practice - OHAYO CENTER</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&family=Sawarabi+Mincho&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4A90E2;
            --secondary-color: #F5F7FA;
            --text-color: #333;
            --accent-color: #E74C3C;
            --bmc-color: #FFDD00;
        }

        /* --- ナビゲーションバーのスタイル追加 --- */
        nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(5px);
            padding: 0 5%;
            height: 70px;
            position: fixed;
            width: 100%;
            top: 0;
            left: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
            font-family: 'Noto Sans JP', sans-serif;
            box-sizing: border-box; /* 横スクロール防止 */
        }
        .logo {
            font-family: 'Sawarabi Mincho', serif;
            font-weight: bold;
            font-size: 1.2rem;
            white-space: nowrap;
        }
        .logo a {
            text-decoration: none;
            color: #2c3e50;
        }
        .nav-links {
            list-style: none;
            display: flex;
            gap: 1.2rem;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            text-decoration: none;
            color: #2c3e50;
            font-weight: 500;
            font-size: 0.8rem;
            letter-spacing: 1px;
        }

        /* スマホ用デザイン調整 */
        @media (max-width: 600px) {
            nav { padding: 0 15px; }
            .logo { font-size: 1rem; }
            .nav-links { gap: 0.8rem; }
            .nav-links a { font-size: 0.7rem; }
        }
        /* ------------------------------------- */

        /* bodyのpaddingを変更し、上部に90pxの余白を設ける（メニューに隠れないようにするため） */
        body { font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif; background-color: var(--secondary-color); color: var(--text-color); margin: 0; padding: 90px 20px 20px; }
        .container { max-width: 800px; margin: 0 auto; background-color: #fff; border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); padding: 30px; }
        h1 { text-align: center; color: var(--primary-color); border-bottom: 2px solid var(--primary-color); padding-bottom: 10px; }
        .slide { display: none; }
        .slide.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .question-block { margin-bottom: 35px; padding-bottom: 25px; border-bottom: 1px dashed #ccc; }
        .question-header { font-size: 1.1em; font-weight: bold; margin-bottom: 5px; }
        .english-translation { color: #666; font-size: 0.9em; margin-bottom: 20px; font-style: italic; }
        .sentence-builder { font-size: 1.2em; line-height: 2.5em; margin-bottom: 15px; display: flex; flex-wrap: wrap; align-items: center; }
        .text-part { margin: 0 5px; }
        .drop-slot-wrapper { display: inline-flex; flex-direction: column; align-items: center; margin: 0 5px; }
        .drop-slot { display: inline-block; min-width: 70px; height: 35px; border-bottom: 2px solid #888; text-align: center; line-height: 35px; cursor: pointer; color: var(--primary-color); font-weight: bold; background-color: #f9f9f9; border-radius: 4px 4px 0 0; transition: background-color 0.2s; padding: 0 10px; }
        .drop-slot:hover { background-color: #eef; }
        .word-bank { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px; min-height: 45px; }
        .word-btn { background-color: #fff; color: var(--text-color); border: 2px solid var(--primary-color); padding: 8px 15px; border-radius: 20px; font-size: 1em; cursor: pointer; font-weight: bold; transition: all 0.2s; }
        .word-btn:hover { background-color: var(--primary-color); color: #fff; }
        .action-area { display: flex; align-items: center; gap: 15px; flex-wrap: wrap; }
        .check-btn, .reset-btn { padding: 8px 16px; border-radius: 5px; cursor: pointer; font-size: 1em; border: none; color: white; }
        .check-btn { background-color: var(--primary-color); }
        .reset-btn { background-color: #95a5a6; }
        .result-display { font-weight: bold; font-size: 1.1em; }
        .correct { color: #2ecc71; }
        .incorrect { color: var(--accent-color); }
        .explanation { display: none; margin-top: 15px; background-color: #f8f9fa; padding: 10px; border-left: 4px solid var(--primary-color); font-size: 0.95em; line-height: 1.5; }
        .controls { display: flex; justify-content: space-between; margin-top: 30px; }
        .nav-btn { background-color: #333; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 1em; }
        .nav-btn:disabled { background-color: #ccc; cursor: not-allowed; }
        .progress { text-align: center; font-size: 1.1em; font-weight: bold; margin-top: 20px; }
        .support-section { text-align: center; margin-top: 50px; padding-top: 30px; border-top: 2px solid #eee; }
        .support-section h2 { color: var(--primary-color); font-size: 1.2em; margin-bottom: 10px; }
        .support-section p { color: #666; font-size: 0.95em; margin-bottom: 20px; }
        .bmc-custom-btn { display: inline-flex; align-items: center; justify-content: center; background-color: var(--bmc-color); color: #000; padding: 12px 24px; border-radius: 8px; font-weight: bold; font-size: 1.1em; text-decoration: none; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s, box-shadow 0.2s; }
        .bmc-custom-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
        .bmc-custom-btn span { margin-left: 8px; letter-spacing: 0.5px; }
    </style>
</head>
<body>

<nav>
    <div class="logo"><a href="https://ohayocenter.com/">OHAYO CENTER</a></div>
    <ul class="nav-links">
        <li><a href="https://ohayocenter.com/#lessons">LESSONS</a></li>
        <li><a href="https://ohayocenter.com/#profile">PROFILE</a></li>
        <li><a href="https://ohayocenter.com/#resources">MATERIAL</a></li>
    </ul>
</nav>

<div class="container">
    <h1>JLPT Grammar Practice (Sentence Builder)</h1>
    <p style="text-align: center; color: #666; margin-bottom: 20px;">
        Click the words below to build the correct sentence.<br>
        <span style="font-size: 0.9em;">(Words will move into the blanks. Click a blank to return the word.)</span>
    </p>

    <div id="quiz-container"></div>
    
    <div class="controls">
        <button id="prev-btn" class="nav-btn" onclick="changeSlide(-1)">Previous Slide</button>
        <span class="progress" id="progress-text">Slide 1 / 5</span>
        <button id="next-btn" class="nav-btn" onclick="changeSlide(1)">Next Slide</button>
    </div>

    <div class="support-section">
        <h2>Support OHAYO CENTER</h2>
        <p>If you find these materials helpful, please consider supporting us!</p>
        <a class="bmc-custom-btn" href="https://www.buymeacoffee.com/ohayocenteh" target="_blank">
            ☕️ <span>SUPPORT OHAYO CENTER</span>
        </a>
    </div>
</div>

<script>
    const quizData = [
        // ====== Slide 1 ======
        [
            {
                prefix: "ここに", suffix: "ください。",
                en: "Please write your name here.",
                choices: ["を", "名前", "書いて", "あなたの"],
                ansOrder: [3, 1, 0, 2],
                ansText: "あなたの 名前 を 書いて"
            },
            {
                prefix: "きのう", suffix: "読みました。",
                en: "I read the book I borrowed at the library yesterday.",
                choices: ["としょかん", "で", "借りた", "本を"],
                ansOrder: [0, 1, 2, 3],
                ansText: "としょかん で 借りた 本を"
            },
            {
                prefix: "つくえの", suffix: "あります。",
                en: "There is a bag on the desk.",
                choices: ["上", "かばん", "が", "に"],
                ansOrder: [0, 3, 1, 2],
                ansText: "上 に かばん が"
            },
            {
                prefix: "これは", suffix: "です。",
                en: "This is my friend's camera.",
                choices: ["の", "友だち", "カメラ", "わたしの"],
                ansOrder: [3, 1, 0, 2],
                ansText: "わたしの 友だち の カメラ"
            },
            {
                prefix: "まいあさ", suffix: "しています。",
                en: "I take a walk in the nearby park every morning.",
                choices: ["公園", "を", "散歩", "近くの"],
                ansOrder: [3, 0, 1, 2],
                ansText: "近くの 公園 を 散歩"
            }
        ],
        // ====== Slide 2 ======
        [
            {
                prefix: "山田さんは", suffix: "人ですか。",
                en: "Is Mr. Yamada that person with long hair?",
                choices: ["髪", "長い", "が", "あの"],
                ansOrder: [3, 0, 2, 1],
                ansText: "あの 髪 が 長い"
            },
            {
                prefix: "かばんの", suffix: "ください。",
                en: "Please put the wallet in the bag.",
                choices: ["に", "中", "さいふを", "いれて"],
                ansOrder: [1, 0, 2, 3],
                ansText: "中 に さいふを いれて"
            },
            {
                prefix: "きのうの", suffix: "でした。",
                en: "Yesterday's test was very difficult.",
                choices: ["とても", "は", "テスト", "むずかしかった"],
                ansOrder: [2, 1, 0, 3],
                ansText: "テスト は とても むずかしかった"
            },
            {
                prefix: "東京から", suffix: "かかりますか。",
                en: "How long does it take from Tokyo to Kyoto by bullet train?",
                choices: ["新幹線", "どのくらい", "京都まで", "で"],
                ansOrder: [[2, 0, 3, 1], [0, 3, 2, 1], [2, 1, 0, 3], [0, 3, 1, 2]],
                ansText: "京都まで 新幹線 で どのくらい <br><span style='font-size: 0.9em; color: #666;'>(または: 新幹線 で 京都まで どのくらい など)</span>"
            },
            {
                prefix: "この", suffix: "わかりますか。",
                en: "Do you know how to read this kanji?",
                choices: ["漢字", "読み方", "の", "が"],
                ansOrder: [0, 2, 1, 3],
                ansText: "漢字 の 読み方 が"
            }
        ],
        // ====== Slide 3 ======
        [
            {
                prefix: "日本語の", suffix: "です。",
                en: "Japanese study is very fun.",
                choices: ["べんきょう", "は", "おもしろい", "とても"],
                ansOrder: [0, 1, 3, 2],
                ansText: "べんきょう は とても おもしろい"
            },
            {
                prefix: "この", suffix: "おいしいです。",
                en: "This shop's cake is delicious.",
                choices: ["店", "ケーキ", "の", "は"],
                ansOrder: [0, 2, 1, 3],
                ansText: "店 の ケーキ は"
            },
            {
                prefix: "日本人は", suffix: "食べます。",
                en: "Japanese people eat meals holding a rice bowl.",
                choices: ["お茶わん", "持って", "を", "ごはんを"],
                ansOrder: [0, 2, 1, 3],
                ansText: "お茶わん を 持って ごはんを"
            },
            {
                prefix: "田中さんは", suffix: "着ています。",
                en: "Mr. Tanaka is wearing an anime shirt.",
                choices: ["の", "シャツ", "アニメ", "を"],
                ansOrder: [2, 0, 1, 3],
                ansText: "アニメ の シャツ を"
            },
            {
                prefix: "わたしは", suffix: "が好きです。",
                en: "I like listening to music.",
                choices: ["音楽", "聞く", "の", "を"],
                ansOrder: [0, 3, 1, 2],
                ansText: "音楽 を 聞く の"
            }
        ],
        // ====== Slide 4 ======
        [
            {
                prefix: "びょういんの", suffix: "ください。",
                en: "Please do not run inside the hospital.",
                choices: ["で", "走らないで", "中", "は"],
                ansOrder: [2, 0, 3, 1],
                ansText: "中 で は 走らないで"
            },
            {
                prefix: "富士山は", suffix: "山です。",
                en: "Mt. Fuji is the highest mountain in Japan.",
                choices: ["日本", "一番", "で", "高い"],
                ansOrder: [[0, 2, 1, 3], [1, 0, 2, 3]],
                ansText: "日本 で 一番 高い <br><span style='font-size: 0.9em; color: #666;'>(または: 一番 日本 で 高い)</span>"
            },
            {
                prefix: "家族", suffix: "だれですか。",
                en: "Who is the tallest in your family?",
                choices: ["の", "なか", "で", "一番背が高いのは"],
                ansOrder: [0, 1, 2, 3],
                ansText: "の なか で 一番背が高いのは"
            },
            {
                prefix: "ケーキと", suffix: "好きですか。",
                en: "Which do you like better, cake or ice cream?",
                choices: ["どちら", "と", "が", "アイスクリーム"],
                ansOrder: [3, 1, 0, 2],
                ansText: "アイスクリーム と どちら が"
            },
            {
                prefix: "部屋が", suffix: "つけましょう。",
                en: "The room has gotten dark, so let's turn on the light.",
                choices: ["暗く", "から", "なった", "電気を"],
                ansOrder: [0, 2, 1, 3],
                ansText: "暗く なった から 電気を"
            }
        ],
        // ====== Slide 5 ======
        [
            {
                prefix: "あした", suffix: "行きませんか。",
                en: "Won't you go shopping at the department store tomorrow?",
                choices: ["デパート", "買い物", "へ", "に"],
                ansOrder: [[0, 2, 1, 3], [1, 3, 0, 2]],
                ansText: "デパート へ 買い物 に <br><span style='font-size: 0.9em; color: #666;'>(または: 買い物 に デパート へ)</span>"
            },
            {
                prefix: "わたしは", suffix: "できます。",
                en: "I can play the guitar.",
                choices: ["を", "弾く", "ギター", "ことが"],
                ansOrder: [2, 0, 1, 3],
                ansText: "ギター を 弾く ことが"
            },
            {
                prefix: "", suffix: "前に、手を洗います。",
                en: "I wash my hands before eating breakfast.",
                choices: ["ごはん", "食べる", "を", "朝"],
                ansOrder: [3, 0, 2, 1],
                ansText: "朝 ごはん を 食べる"
            },
            {
                prefix: "", suffix: "ことがありますか。",
                en: "Have you ever eaten Japanese sushi?",
                choices: ["食べた", "すし", "を", "日本の"],
                ansOrder: [3, 1, 2, 0],
                ansText: "日本の すし を 食べた"
            },
            {
                prefix: "この", suffix: "いいですか。",
                en: "May I borrow this dictionary?",
                choices: ["借りて", "辞書", "も", "を"],
                ansOrder: [1, 3, 0, 2],
                ansText: "辞書 を 借りて も"
            }
        ]
    ];

    let currentSlide = 0;

    function renderQuiz() {
        const container = document.getElementById('quiz-container');
        container.innerHTML = '';

        quizData.forEach((slideData, slideIndex) => {
            const slideDiv = document.createElement('div');
            slideDiv.className = `slide ${slideIndex === 0 ? 'active' : ''}`;
            slideDiv.id = `slide-${slideIndex}`;

            slideData.forEach((qData, qIndex) => {
                const qId = `s${slideIndex}_q${qIndex}`;
                
                const questionBlock = document.createElement('div');
                questionBlock.className = 'question-block';

                let choicesHTML = '';
                qData.choices.forEach((choice, idx) => {
                    choicesHTML += `<button class="word-btn" id="btn-${qId}-${idx}" onclick="selectWord('${qId}', ${idx}, '${choice}')">${choice}</button>`;
                });

                questionBlock.innerHTML = `
                    <div class="question-header">Q${(slideIndex * 5) + qIndex + 1}.</div>
                    <div class="english-translation">${qData.en}</div>
                    
                    <div class="sentence-builder" id="builder-${qId}">
                        ${qData.prefix ? `<span class="text-part">${qData.prefix}</span>` : ''}
                        
                        <div class="drop-slot-wrapper"><span class="drop-slot" id="slot-${qId}-0" onclick="returnWord('${qId}', 0)"></span></div>
                        <div class="drop-slot-wrapper"><span class="drop-slot" id="slot-${qId}-1" onclick="returnWord('${qId}', 1)"></span></div>
                        <div class="drop-slot-wrapper"><span class="drop-slot" id="slot-${qId}-2" onclick="returnWord('${qId}', 2)"></span></div>
                        <div class="drop-slot-wrapper"><span class="drop-slot" id="slot-${qId}-3" onclick="returnWord('${qId}', 3)"></span></div>

                        ${qData.suffix ? `<span class="text-part">${qData.suffix}</span>` : ''}
                    </div>

                    <div class="word-bank" id="bank-${qId}">${choicesHTML}</div>

                    <div class="action-area">
                        <button class="check-btn" onclick="checkAnswer('${qId}')">Check Answer</button>
                        <button class="reset-btn" onclick="resetQuestion('${qId}')">Reset</button>
                        <span id="result-${qId}" class="result-display"></span>
                    </div>

                    <div id="explanation-${qId}" class="explanation">
                        <strong>Correct Sentence:</strong><br>
                        ${qData.prefix} <span style="color:var(--primary-color)">${qData.ansText}</span> ${qData.suffix}
                    </div>
                `;
                slideDiv.appendChild(questionBlock);
            });
            container.appendChild(slideDiv);
        });
        updateButtons();
    }

    window.selectWord = function(qId, choiceIdx, text) {
        for(let i=0; i<4; i++) {
            const slot = document.getElementById(`slot-${qId}-${i}`);
            if(!slot.hasAttribute('data-choice')) {
                slot.innerText = text;
                slot.setAttribute('data-choice', choiceIdx);
                document.getElementById(`btn-${qId}-${choiceIdx}`).style.display = 'none';
                break;
            }
        }
    };

    window.returnWord = function(qId, slotIdx) {
        const slot = document.getElementById(`slot-${qId}-${slotIdx}`);
        if(slot.hasAttribute('data-choice')) {
            const choiceIdx = slot.getAttribute('data-choice');
            document.getElementById(`btn-${qId}-${choiceIdx}`).style.display = 'inline-block';
            slot.innerText = '';
            slot.removeAttribute('data-choice');
        }
    };

    window.resetQuestion = function(qId) {
        for(let i=0; i<4; i++) {
            returnWord(qId, i);
        }
        document.getElementById(`result-${qId}`).textContent = '';
        document.getElementById(`explanation-${qId}`).style.display = 'none';
    };

    window.checkAnswer = function(qId) {
        const parts = qId.replace('s', '').split('_q');
        const sIdx = parseInt(parts[0]);
        const qIdx = parseInt(parts[1]);
        const qData = quizData[sIdx][qIdx];

        let userArr = [];
        let isComplete = true;

        for(let i=0; i<4; i++) {
            const slot = document.getElementById(`slot-${qId}-${i}`);
            if(slot.hasAttribute('data-choice')) {
                userArr.push(parseInt(slot.getAttribute('data-choice')));
            } else {
                isComplete = false;
            }
        }

        const resultSpan = document.getElementById(`result-${qId}`);
        const expDiv = document.getElementById(`explanation-${qId}`);

        if(!isComplete) {
            resultSpan.textContent = "Please place all words.";
            resultSpan.className = "result-display incorrect";
            return;
        }

        const validOrders = Array.isArray(qData.ansOrder[0]) ? qData.ansOrder : [qData.ansOrder];
        const userStr = userArr.join(',');
        
        let isCorrect = false;
        for(let order of validOrders) {
            if (userStr === order.join(',')) {
                isCorrect = true;
                break;
            }
        }

        if(isCorrect) {
            resultSpan.textContent = "⭕️ Correct!";
            resultSpan.className = "result-display correct";
        } else {
            resultSpan.textContent = "❌ Incorrect";
            resultSpan.className = "result-display incorrect";
        }
        expDiv.style.display = "block";
    };

    window.changeSlide = function(direction) {
        const slides = document.querySelectorAll('.slide');
        slides[currentSlide].classList.remove('active');
        
        currentSlide += direction;
        
        slides[currentSlide].classList.add('active');
        updateButtons();
    };

    function updateButtons() {
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressText = document.getElementById('progress-text');

        prevBtn.disabled = currentSlide === 0;
        nextBtn.disabled = currentSlide === quizData.length - 1;
        progressText.textContent = `Slide ${currentSlide + 1} / ${quizData.length}`;
    }

    window.onload = renderQuiz;
</script>

</body>
</html>

